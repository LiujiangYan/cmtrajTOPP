clear
clc

t = 0:0.05:2;
t = t';

start = [0.3, 0.3, 0.6];
midpoint1 = [-0.3, -0.3, 0.3];
midpoint2 = [0.3, -0.3, 0.3];
midpoint3 = [-0.3, 0.3, 0.6];
goal = [0.3, 0.3, 0.6];

% qc1
q1 = [4.383545 3.212670 1.678350 4.533758 0.328844 0];
q2 = [0.891898 2.503581 1.865197 5.056000 3.820491 0.000000];
qc1 = jtraj(q1, q2, t);

% differential of qc1 to time
for i=1:6
    qc1_dt(:,i) = gradient(qc1(:,i))./gradient(t);
    qc1_ddt(:,i) = gradient(qc1_dt(:,i))./gradient(t);
    % uncomment the following lines to plot the differential of joint variable via distance
    % plot(t, qc_dt(:,i));
    % hold on;
end

time_d = gradient(t);
% output qc1 in TOPP format
qc1_for = qc1(1:end-1,:);
qc1_lat = qc1(2:end,:);
qc1_dt_for = qc1_dt(1:end-1,:);
qc1_dt_lat = qc1_dt(2:end,:);
% save in csv file
output = [qc1_for, qc1_lat, qc1_dt_for, qc1_dt_lat, time_d(1:end-1,:)];
csvwrite('matTOPP/qc1forTOPP.csv',output)

%qc2
qc2 = [0.891898 2.503581 1.865197 5.056000 3.820491 0.000000;
0.893281 2.503020 1.867209 5.054549 3.819108 0.000000;
0.897482 2.501340 1.873271 5.050167 3.814907 0.000000;
0.904517 2.498602 1.883255 5.042921 3.807872 0.000000;
0.914546 2.494858 1.897137 5.032783 3.797843 0.000000;
0.927694 2.490222 1.914735 5.019822 3.784695 0.000000;
0.944205 2.484808 1.935923 5.004047 3.768184 0.000000;
0.964295 2.478791 1.960424 4.985563 3.748094 0.000000;
0.988352 2.472338 1.988056 4.964384 3.724037 0.000000;
1.016744 2.465672 2.018481 4.940625 3.695645 0.000000;
1.049975 2.459024 2.051382 4.914371 3.662414 0.000000;
1.088620 2.452659 2.086360 4.885759 3.623769 0.000000;
1.133340 2.446854 2.122949 4.854975 3.579049 0.000000;
1.184859 2.441901 2.160579 4.822298 3.527530 0.000000;
1.243021 2.438121 2.198019 4.788638 3.469368 0.000000;
1.304982 2.435764 2.232812 4.756202 3.407407 0.000000;
1.370447 2.434703 2.264620 4.725455 3.341942 0.000000;
1.439232 2.434747 2.293238 4.696793 3.273157 0.000000;
1.511019 2.435655 2.318447 4.670676 3.201370 0.000000;
1.585334 2.437143 2.340025 4.647611 3.127055 0.000000;
1.661550 2.438898 2.357752 4.628128 3.050839 0.000000;
1.738897 2.440606 2.371429 4.612743 2.973492 0.000000;
1.816495 2.441976 2.380887 4.601915 2.895894 0.000000;
1.893409 2.442784 2.386000 4.595993 2.818980 0.000000;
1.968709 2.442899 2.386699 4.595180 2.743680 0.000000;
2.041542 2.442300 2.382974 4.599504 2.670847 0.000000;
2.111185 2.441087 2.374876 4.608815 2.601204 0.000000;
2.176831 2.439464 2.362572 4.622742 2.535558 0.000000;
2.234895 2.437800 2.347266 4.639712 2.477494 0.000000;
2.285006 2.436375 2.330125 4.658278 2.427383 0.000000;
2.327916 2.435343 2.312049 4.677386 2.384473 0.000000;
2.364488 2.434757 2.293764 4.696256 2.347901 0.000000;
2.395381 2.434602 2.275947 4.714230 2.317008 0.000000;
2.421282 2.434807 2.259110 4.730861 2.291107 0.000000;
2.442718 2.435276 2.243713 4.745788 2.269671 0.000000;
2.460144 2.435903 2.230121 4.758754 2.252245 0.000000;
2.473929 2.436582 2.218628 4.769568 2.238460 0.000000;
2.484378 2.437217 2.209450 4.778111 2.228011 0.000000;
2.491691 2.437730 2.202776 4.784272 2.220698 0.000000;
2.496016 2.438062 2.198726 4.787990 2.216373 0.000000;
2.497442 2.438176 2.197374 4.789228 2.214947 0.000000];

% differential of qc1 to time
for i=1:6
    qc2_dt(:,i) = gradient(qc2(:,i))./gradient(t);
    qc2_ddt(:,i) = gradient(qc2_dt(:,i))./gradient(t);
    % uncomment the following lines to plot the differential of joint variable via distance
    % plot(t, qc_dt(:,i));
    % hold on;
end

% output qc2 in TOPP format
qc2_for = qc2(1:end-1,:);
qc2_lat = qc2(2:end,:);
qc2_dt_for = qc2_dt(1:end-1,:);
qc2_dt_lat = qc2_dt(2:end,:);
% save in csv file
output = [qc2_for, qc2_lat, qc2_dt_for, qc2_dt_lat, time_d(1:end-1,:)];
csvwrite('matTOPP/qc2forTOPP.csv',output)

% qc3
q3 = [2.497442 2.438176 2.197374 4.789228 2.214947 0.000000];
q4 = [5.844370 3.205317 1.380792 4.838670 5.151204 0.000000];
qc3 = jtraj(q3, q4, t);
dif = diff(qc3(:,1));
for i=2:length(dif)+1
    qc3(i,5) = qc3(i-1,5) - dif(i-1);
end

% differential of qc1 to time
for i=1:6
    qc3_dt(:,i) = gradient(qc3(:,i))./gradient(t);
    qc3_ddt(:,i) = gradient(qc3_dt(:,i))./gradient(t);
    % uncomment the following lines to plot the differential of joint variable via distance
    % plot(t, qc_dt(:,i));
    % hold on;
end

% output qc3 in TOPP format
qc3_for = qc3(1:end-1,:);
qc3_lat = qc3(2:end,:);
qc3_dt_for = qc3_dt(1:end-1,:);
qc3_dt_lat = qc3_dt(2:end,:);
% save in csv file
output = [qc3_for, qc3_lat, qc3_dt_for, qc3_dt_lat, time_d(1:end-1,:)];
csvwrite('matTOPP/qc3forTOPP.csv',output)

% q4
qc4 = [5.844370 3.205317 1.380792 4.838670 5.151204 0.000000;
5.843615 3.205114 1.382751 4.836914 5.151959 0.000000;
5.841319 3.204518 1.388644 4.831616 5.154255 0.000000;
5.837466 3.203592 1.398312 4.822875 5.158109 0.000000;
5.831956 3.202417 1.411675 4.810686 5.163619 0.000000;
5.824702 3.201120 1.428484 4.795174 5.170872 0.000000;
5.815542 3.199848 1.448529 4.776401 5.180032 0.000000;
5.804319 3.198776 1.471447 4.754555 5.191256 0.000000;
5.790764 3.198093 1.496956 4.729729 5.204810 0.000000;
5.774600 3.198003 1.524630 4.702145 5.220974 0.000000;
5.755440 3.198708 1.554064 4.672006 5.240134 0.000000;
5.732818 3.200403 1.584792 4.639583 5.262756 0.000000;
5.706156 3.203259 1.616303 4.605216 5.289419 0.000000;
5.674754 3.207397 1.648024 4.569358 5.320820 0.000000;
5.638356 3.212774 1.678875 4.533130 5.357218 0.000000;
5.598388 3.218947 1.706894 4.498936 5.397186 0.000000;
5.554706 3.225625 1.731944 4.467208 5.440868 0.000000;
5.507053 3.232511 1.754008 4.438259 5.488521 0.000000;
5.455223 3.239291 1.773061 4.412426 5.540351 0.000000;
5.399088 3.245644 1.789077 4.390057 5.596486 0.000000;
5.338635 3.251253 1.802029 4.371496 5.656939 0.000000;
5.273998 3.255827 1.811892 4.357059 5.721576 0.000000;
5.205485 3.259118 1.818645 4.347014 5.790090 0.000000;
5.133588 3.260942 1.822274 4.341563 5.861986 0.000000;
5.058979 3.261193 1.822769 4.340816 5.936595 0.000000;
4.982477 3.259859 1.820128 4.344791 6.013097 0.000000;
4.904992 3.257015 1.814360 4.353404 6.090582 0.000000;
4.827776 3.252840 1.805517 4.366420 6.167798 0.000000;
4.755872 3.247892 1.794390 4.382495 6.239702 0.000000;
4.690943 3.242666 1.781763 4.400350 0.021446 0.000000;
4.633134 3.237506 1.768259 4.419013 0.079255 0.000000;
4.582201 3.232646 1.754409 4.437723 0.130188 0.000000;
4.537953 3.228249 1.740731 4.455797 0.174436 0.000000;
4.499974 3.224396 1.727645 4.472737 0.212415 0.000000;
4.467927 3.221123 1.715541 4.488114 0.244462 0.000000;
4.441459 3.218428 1.704750 4.501600 0.270930 0.000000;
4.420257 3.216291 1.695549 4.512939 0.292132 0.000000;
4.404027 3.214675 1.688151 4.521953 0.308362 0.000000;
4.392589 3.213550 1.682743 4.528485 0.319800 0.000000;
4.385792 3.212888 1.679451 4.532439 0.326597 0.000000;
4.383545 3.212670 1.678350 4.533758 0.328844 0.000000];

% differential of qc1 to time
for i=1:6
    qc4_dt(:,i) = gradient(qc4(:,i))./gradient(t);
    qc4_ddt(:,i) = gradient(qc4_dt(:,i))./gradient(t);
    % uncomment the following lines to plot the differential of joint variable via distance
    % plot(t, qc_dt(:,i));
    % hold on;
end

qc4_dt(29,5) = qc4_dt(28,5);
qc4_dt(30,5) = qc4_dt(31,5);

% output qc3 in TOPP format
qc4_for = qc4(1:end-1,:);
qc4_lat = qc4(2:end,:);
qc4_dt_for = qc4_dt(1:end-1,:);
qc4_dt_lat = qc4_dt(2:end,:);
% save in csv file
output = [qc4_for, qc4_lat, qc4_dt_for, qc4_dt_lat, time_d(1:end-1,:)];
csvwrite('matTOPP/qc4forTOPP.csv',output)